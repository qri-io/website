<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.49.2" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Starlark Examples </title>

  
  <meta name="description" content="example starlark snippits"> 
  
  
  
  
  

  

  <meta name="author" content="qri">


  <meta property="og:title" content="Starlark Examples" />
<meta property="og:description" content="example starlark snippits" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://qri.io/docs/reference/starlark_examples/" /><meta property="article:published_time" content="2018-12-20T00:00:00-04:00"/>
<meta property="article:modified_time" content="2018-12-20T00:00:00-04:00"/>

  




  
  
  
  
  

  <link rel="canonical" href="https://qri.io/docs/reference/starlark_examples/">  

  <link href="../../../favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../../../css/font.css" rel="stylesheet" type="text/css">
  <link href="../../../css/qri.css" rel="stylesheet" type="text/css">
  

  <script src="../../../js/jquery-2.1.4.min.js" type="text/javascript"></script>
  <link rel="stylesheet" href="../../../css/highlight.default.min.css">
  <link rel="stylesheet" href="../../../css/highlight.theme.tomorrow.css">
  <script src="../../../js/highlight.pack.js"></script>
  <script>
    window.onload = function(e) {
      let elements = document.querySelectorAll('.highlight pre')
      Array.from(elements).forEach((block, i) => {
        hljs.highlightBlock(block)
      })
    }
  </script>

  <script type="text/javascript" src="../../../js/tocbot.min.js"></script>

  
    <script type="text/javascript">
     !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
      analytics.load("b4iAxJT8ISitRFQ6qZGS9w7RTnaOpvju");
      analytics.page()
    }}();
    </script>
  
</head>


<body class="page-kube docs " >
  <header></header>
  <main>
<div id="docs_page" class="docs">
  <div id="docs_sidebar_toggle">
  <div class="icon">
    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 10 10" style="enable-background:new 0 0 10 10;" xml:space="preserve">
      <style type="text/css">
        .st0{fill:#FFFFFF;}
      </style>
      <path class="st0" d="M9,2.3H1c-0.44,0-0.8-0.36-0.8-0.8V1.3c0-0.44,0.36-0.8,0.8-0.8H9c0.44,0,0.8,0.36,0.8,0.8V1.5
        C9.8,1.94,9.44,2.3,9,2.3z"/>
      <path class="st0" d="M9,5.9H1c-0.44,0-0.8-0.36-0.8-0.8V4.9c0-0.44,0.36-0.8,0.8-0.8H9c0.44,0,0.8,0.36,0.8,0.8V5.1
        C9.8,5.54,9.44,5.9,9,5.9z"/>
      <path class="st0" d="M9,9.5H1c-0.44,0-0.8-0.36-0.8-0.8V8.5c0-0.44,0.36-0.8,0.8-0.8H9c0.44,0,0.8,0.36,0.8,0.8V8.7
        C9.8,9.14,9.44,9.5,9,9.5z"/>
    </svg>
  </div>
</div>
<nav id="docs_sidebar">
  <div class="content">
    <div class="logotype">
      <a href="../../../" title="home" class="title">qri</a>
      <p class="subhead">docs</p>
    </div>
    <div class="pages">
      <ul>
      
        
          
            <li class="section"><a href="../../../docs/tutorials/"><h5>tutorials</h5></a></li>
            <ul>
              
                <li class="page"><a href="../../../docs/tutorials/frontend/">Frontend</a></li>
              
                <li class="page"><a href="../../../docs/tutorials/cli_quickstart/">CLI quickstart</a></li>
              
                <li class="page"><a href="../../../docs/tutorials/starlark_transformations/">Starlark Transformations</a></li>
              
            </ul>
          
            <li class="section"><a href="../../../docs/reference/"><h5>reference</h5></a></li>
            <ul>
              
                <li class="page"><a href="../../../docs/reference/starlark_examples/">Starlark Examples</a></li>
              
                <li class="page"><a href="../../../docs/reference/starlib_qri_ds/">Starlark: qri &amp; ds modules</a></li>
              
                <li class="page"><a href="../../../docs/reference/starlib/">Starlark: standard library</a></li>
              
                <li class="page"><a href="../../../docs/reference/cli_commands/">CLI commands</a></li>
              
                <li class="page"><a href="../../../docs/reference/dataset/">Dataset</a></li>
              
                <li class="page"><a href="../../../docs/reference/starlark_syntax/">Starlark Language</a></li>
              
            </ul>
          
            <li class="section"><a href="../../../docs/concepts/"><h5>concepts</h5></a></li>
            <ul>
              
                <li class="page"><a href="../../../docs/concepts/content-addressing/">Content Addressing</a></li>
              
                <li class="page"><a href="../../../docs/concepts/dataset/">Datasets</a></li>
              
                <li class="page"><a href="../../../docs/concepts/distributed-storage/">Distributed Storage</a></li>
              
                <li class="page"><a href="../../../docs/concepts/names/">Naming</a></li>
              
                <li class="page"><a href="../../../docs/concepts/overview/">Overview</a></li>
              
            </ul>
          
        
      
        
      
        
      
        
      
      </ul>
    </div>
  </div>
  <br />
</nav>
  <section id="main">
    <div class="content">
      

<h3 id="qri-and-dataset-modules">qri and dataset modules</h3>

<p>In Qri two &ldquo;nonstandard&rdquo; modules specific to qri are available. these modules are <em>not</em> considered part of the standard library project, and are defined in a <a href="https://github.com/qri-io/startf">different repository</a>. They&rsquo;re described here to keep documentation complete:</p>

<ul>
<li><a href="#qri_module">qri</a></li>
<li><a href="#dataset_object">ds or dataset</a></li>
</ul>

<h3 id="modules">Modules</h3>

<ul>
<li><a href="#html_module">html</a></li>
<li><a href="#http_module">http</a></li>
<li><a href="#math_module">math</a></li>
<li><a href="#re_module">re</a></li>
<li><a href="#time_module">time</a></li>
<li><a href="#xlsx_module">xlsx</a></li>
<li><a href="#zipfile_module">zipfile</a></li>
</ul>

<hr />

<p><a id="html_module"></a></p>

<h2 id="html-module">html module</h2>

<p><em>can only be used in the <code>download</code> function. You must use the <code>html</code> function to parse an html response, to get a document  object that you can traverse</em></p>

<p>To load and parse:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>
<span class="n">load</span><span class="p">(</span><span class="s2">&#34;http.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;http&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">res</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://some-website.com&#34;</span><span class="p">)</span>
  <span class="c1"># parses the response body into something that </span>
  <span class="c1"># can be traversed using a jquery-like syntax</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">content</span><span class="p">())</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><em>The following methods can be used on the document object that gets returned by using the <code>html</code> function:</em></p>

<ul>
<li><a href="#attr">attr</a></li>
<li><a href="#children">children</a></li>
<li><a href="#children_filtered">children_filtered</a></li>
<li><a href="#contents">contents</a></li>
<li><a href="#eq">eq</a></li>
<li><a href="#find">find</a></li>
<li><a href="#first">first</a></li>
<li><a href="#filter">filter</a></li>
<li><a href="#get">get</a></li>
<li><a href="#has">has</a></li>
<li><a href="#last">last</a></li>
<li><a href="#len">len</a></li>
<li><a href="#parent">parent</a></li>
<li><a href="#parents_until">parents_until</a></li>
<li><a href="#siblings">siblings</a></li>
<li><a href="#html_text">text</a></li>
</ul>

<hr />

<h2 id="function-definitions">Function Definitions:</h2>

<p><a id="attr"></a></p>

<h4 id="attr">attr</h4>

<p><code>selection.attr(attribute)</code></p>

<p>Returns a string of the given attribute for that selection in the document. <code>attribute</code> is a string.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;div title=&#34;hello world&#34; class=&#34;example_class_name&#34;&gt;&lt;p&gt;test&lt;/p&gt;&lt;/div&gt;&#39;</span>
  <span class="c1">#</span>
  <span class="c1"># find returns a list of elements that match the search string:</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;div&#34;</span><span class="p">)</span>
  <span class="c1">#</span>
  <span class="c1"># get the first element in the list:</span>
  <span class="n">div</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
  <span class="c1">#</span>
  <span class="c1"># get the attr with the key &#34;title&#34;</span>
  <span class="n">attr</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="c1"># prints &#34;hello world&#34;</span>
  <span class="c1">#</span>
  <span class="n">ds</span><span class="o">.</span><span class="n">set_body</span><span class="p">([</span><span class="n">attr</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="children"></a></p>

<h4 id="children">children</h4>

<p><code>selection.children()</code></p>

<p>gets the child elements of each element in the Selection. It returns a new Selection object containing these elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># gives you a selection of the body element</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span>
  <span class="c1"># gives you a selection made up of the children of body</span>
  <span class="n">children_len</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">children</span><span class="p">()</span><span class="o">.</span><span class="nb">len</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">children_len</span><span class="p">)</span> <span class="c1"># prints 4, specifically the 4 p elements</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="children_filtered"></a></p>

<h4 id="children-filtered">children_filtered</h4>

<p><code>selection.children_filtered(filter)</code></p>

<p>gets the child elements of each element in the selection, filtered by the specified by the <code>filter</code> string. It returns a new Selection object containing these elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># find the body element and select it&#39;s two div element children</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
  <span class="c1"># filter the divs to get the 2 p elements with class name &#34;.A&#34;</span>
  <span class="n">p_as</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">children_filtered</span><span class="p">(</span><span class="s2">&#34;.A&#34;</span><span class="p">)</span> 
  <span class="k">print</span><span class="p">(</span><span class="n">p_as</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;aa&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="contents"></a></p>

<h4 id="contents">contents</h4>

<p><code>selection.contents()</code></p>

<p>gets the children of each element in the Selection, including text and comment nodes. It returns a new Selection object containing these elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get the body</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">contents</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;2&#34;, the 2 div elements</span>
  <span class="k">print</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;abcd&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="eq"></a></p>

<h4 id="eq">eq</h4>

<p><code>selection.eq(index)</code></p>

<p>returns node i as a new selection</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1">#</span>
  <span class="c1"># get the body</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;p&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;4&#34;, the 4 p elements</span>
  <span class="c1">#</span>
  <span class="c1"># create list of the text in each element:</span>
  <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="nb">len</span><span class="p">()):</span>
    <span class="c1"># use `eq` function to access each node</span>
    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
  <span class="k">print</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="c1"># prints [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;]</span>
  <span class="c1">#</span>
  <span class="n">ds</span><span class="o">.</span><span class="n">set_body</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="find"></a></p>

<h4 id="find">find</h4>

<p><code>selection.find(selector)</code></p>

<p>gets the descendants of each element in the current set of matched elements, filtered by a given <code>selector</code> string. It returns a new Selection containing these matched elements.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get the elements with the class &#34;.B&#34;</span>
  <span class="n">p_Bs</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;.B&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">p_Bs</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;2&#34;, the 2 p elements with class &#34;.B&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">p_Bs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;bb&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="first"></a></p>

<h4 id="first">first</h4>

<p><code>selection.first()</code></p>

<p>returns the first element of the selection as a new selection</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get the body</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span>
  <span class="c1"># get the children of the body, in this case 2 divs</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
  <span class="c1"># get the first div</span>
  <span class="n">div</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;ab&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="filter"></a></p>

<h4 id="filter">filter</h4>

<p><code>selection.filter(selector)</code></p>

<p>reduces the set of matched elements to those that match the <code>selector</code> string. It returns a new Selection object for this subset of matching elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get a list of all the p tags</span>
  <span class="n">ps</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;p&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;4&#34;, the 4 p elements</span>
  <span class="c1"># filter ps to find elements with class &#34;.B&#34;</span>
  <span class="n">p_Bs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s2">&#34;.B&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">p_Bs</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;2&#34;, the 2 p elements with class &#34;.B&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">p_Bs</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;bb&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="has"></a></p>

<h4 id="has">has</h4>

<p><code>selection.has()</code></p>

<p>reduces the set of matched elements to those that have a descendant that matches the <code>selector</code> string. It returns a new Selection object with the matching elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get body element</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
  <span class="c1"># get div that has a child with class &#34;.A&#34;</span>
  <span class="n">div</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s2">&#34;.A&#34;</span><span class="p">)</span>
  <span class="n">ps</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;ab&#34;, 2 p elements that exist in the div element</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="last"></a></p>

<h4 id="last">last</h4>

<p><code>selection.last()</code></p>

<p>returns the last element of the selection as a new selection</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get the body</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span>
  <span class="c1"># get the children of the body, in this case 2 divs</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
  <span class="c1"># get the first div</span>
  <span class="n">div</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;cd&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="len"></a></p>

<h4 id="len">len</h4>

<p><code>selection.len()</code></p>

<p>returns the length of the nodes in the selection as an integer</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># get the body</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;4&#34;, the 4 p elements</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="parent}"></a></p>

<h4 id="parent">parent</h4>

<p><code>selection.parent()</code></p>

<p>gets the parent of each element in the Selection. It returns a new Selection object containing the matched elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div title=&#34;hi&#34;&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># select p elements</span>
  <span class="n">ps</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;p&#34;</span><span class="p">)</span>
  <span class="c1"># get parents of p elements, in this case 2 divs</span>
  <span class="n">divs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">divs</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># 2 div parent elements</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">divs</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="parents_until"></a></p>

<h4 id="parents-until">parents_until</h4>

<p><code>selection.parents_until(selector)</code></p>

<p>gets the ancestors of each element in the Selection, up to but not including the element matched by the <code>selector</code> string. It returns a new Selection object containing the matched elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div title=&#34;hi&#34;&gt;&lt;span title=&#34;bye&#34;&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;&lt;div title=&#34;woo&#34;&gt;&lt;span title=&#34;weee&#34;&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># select p elements</span>
  <span class="n">ps</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;p&#34;</span><span class="p">)</span>
  <span class="c1"># get all parents of the p elements, but doesn&#39;t include the body element</span>
  <span class="n">parents</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">parents_until</span><span class="p">(</span><span class="s2">&#34;body&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">parents</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># 4 div parent elements</span>
  <span class="k">print</span><span class="p">(</span><span class="n">parents</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">))</span> <span class="c1"># prints &#34;bye&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">parents</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">))</span> <span class="c1"># prints &#34;hi&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">parents</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">))</span> <span class="c1"># prints &#34;weee&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">parents</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">))</span> <span class="c1"># prints &#34;woo&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="siblings"></a></p>

<h4 id="siblings">siblings</h4>

<p><code>selection.siblings()</code></p>

<p>gets the siblings of each element in the Selection. It returns a new Selection object containing the matched elements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="c1"># select elements with class &#34;.A&#34;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;.A&#34;</span><span class="p">)</span>
  <span class="c1"># get all parents of the p elements, but doesn&#39;t include the body element</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">siblings</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="nb">len</span><span class="p">())</span> <span class="c1"># prints &#34;1&#34;, the p element with class &#34;.B&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="c1"># prints &#34;b&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="html_text"></a></p>

<h4 id="text">text</h4>

<p><code>text()</code></p>

<p>gets the combined text contents of each element in the set of matched elements, including their descendants</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">example_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;body&gt;&lt;div&gt;&lt;p class=&#34;A&#34;&gt;a&lt;/p&gt;&lt;p class=&#34;B&#34;&gt;b&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class=&#34;C&#34;&gt;c&lt;/p&gt;&lt;p class=&#34;D&#34;&gt;d&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">example_html</span><span class="p">)</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="c1"># prints &#34;abcd&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<hr />

<p><a id="http_module"></a></p>

<h2 id="http-module">http module</h2>

<p><em>you can access these methods from the <code>http</code> module</em></p>

<ul>
<li><a href="#delete">http.delete</a></li>
<li><a href="#http.get">http.get</a></li>
<li><a href="#options">http.options</a></li>
<li><a href="#patch">http.patch</a></li>
<li><a href="#post">http.post</a></li>
<li><a href="#put">http.put</a></li>
</ul>

<h5 id="response-object">response object</h5>

<p><em>you can access these methods from a response object</em></p>

<ul>
<li><a href="#content">content</a></li>
<li><a href="#encoding">encoding</a></li>
<li><a href="#headers">headers</a></li>
<li><a href="#json">json</a></li>
<li><a href="#status_code">status_code</a></li>
<li><a href="#text">text</a></li>
<li><a href="#url">url</a></li>
</ul>

<hr />

<h2 id="function-definitions-1">Function Definitions:</h2>

<p><a id="delete"></a></p>

<h4 id="delete">delete</h4>

<p><code>http.delete(url, params, headers, data, jsondata, auth)</code></p>

<p>sends a DELETE request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>

<p><a id="get"></a></p>

<h4 id="get">get</h4>

<p><code>http.get(url, params, headers, data, jsondata, auth)</code></p>

<p>sends a GET request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;http.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;http&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">res</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://www.fake-json-response-endpoint.com&#34;</span><span class="p">)</span>
  <span class="n">ds</span><span class="o">.</span><span class="n">set_body</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="options"></a></p>

<h4 id="options">options</h4>

<p><code>http.options(url, params, headers, data, jsondata, auth)</code></p>

<p>Sends an OPTIONS request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>

<p><a id="patch"></a></p>

<h4 id="patch">patch</h4>

<p><code>http.patch(url, params, headers, data, jsondata, auth)</code></p>

<p>Sends a PATCH request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>

<p><a id="post"></a></p>

<h4 id="post">post</h4>

<p><code>http.post(url, params, headers, data, jsondata, auth)</code></p>

<p>Sends a POST request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>

<p><a id="put"></a></p>

<h4 id="put">put</h4>

<p><code>http.put(url, params, headers, data, jsondata, auth)</code></p>

<p>Sends a PUT request to the given url. Returns a response.</p>

<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>optional?</th>
</tr>
</thead>

<tbody>
<tr>
<td>url</td>
<td>string url</td>
<td>no</td>
</tr>

<tr>
<td>params</td>
<td>dictionary of param names to param values</td>
<td>yes</td>
</tr>

<tr>
<td>headers</td>
<td>dictionary of header names to header values</td>
<td>yes</td>
</tr>

<tr>
<td>data</td>
<td>dictionary</td>
<td>yes</td>
</tr>

<tr>
<td>jsondata</td>
<td>dictionary or list</td>
<td>yes</td>
</tr>

<tr>
<td>auth</td>
<td>string</td>
<td>yes</td>
</tr>
</tbody>
</table>

<hr />

<h2 id="response">response</h2>

<p><a id="content"></a></p>

<h4 id="content">content</h4>

<p><code>response.content()</code></p>

<p>returns the raw data as a string. This string can be passed to <code>html(content_string)</code> to return a document that can be parsed by the <code>html</code> functions.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;http.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;http&#34;</span><span class="p">)</span>
<span class="n">load</span><span class="p">(</span><span class="s2">&#34;html.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">res</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://some-website-to-get-html.com&#34;</span><span class="p">)</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">html</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">content</span><span class="p">())</span>
  <span class="c1"># do stuff here with html document</span>
  <span class="n">ds</span><span class="o">.</span><span class="n">set_body</span><span class="p">(</span><span class="n">some_data</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="encoding"></a></p>

<h4 id="encoding">encoding</h4>

<p><code>response.encoding</code></p>

<p>a string, the different forms of encoding used in the response.</p>

<p><a id="headers"></a></p>

<h4 id="headers">headers</h4>

<p><code>response.headers</code></p>

<p>a dictionary of the response headers.</p>

<p><a id="json"></a></p>

<h4 id="json">json</h4>

<p><code>response.json()</code></p>

<p>attempts the response body as json.</p>

<p><a id="status_code"></a></p>

<h4 id="status-code">status_code</h4>

<p><code>response.status_code</code></p>

<p>an integer, the status code of the response.</p>

<p><a id="text"></a></p>

<h4 id="text-1">text</h4>

<p><code>response.text()</code></p>

<p>returns the raw data as a string. This string can be passed to <code>html(text)</code> to return a document that can be parsed by the <code>html</code> functions.</p>

<p><a id="url"></a></p>

<h4 id="url">url</h4>

<p><code>response.url</code></p>

<p>a string representation of the url</p>

<hr />

<p><a id="math_module"></a></p>

<h2 id="math-module">math module</h2>

<p><em>docs coming soon. In the meantime see <a href="https://godoc.org/github.com/qri-io/starlib/math">https://godoc.org/github.com/qri-io/starlib/math</a></em></p>

<p><a id="re_module"></a></p>

<h2 id="re-module">re module</h2>

<p><em>docs coming soon. In the meantime see <a href="https://godoc.org/github.com/qri-io/starlib/re">https://godoc.org/github.com/qri-io/starlib/re</a></em></p>

<p><a id="time_module"></a></p>

<h2 id="time-module">time module</h2>

<p><em>you can access these methods from the <code>time</code> module:</em></p>

<ul>
<li><a href="#time">time.time</a></li>
<li><a href="#duration">time.duration</a><br /></li>
<li><a href="#location">time.location</a><br /></li>
<li><a href="#now">time.now</a><br /></li>
</ul>

<h5 id="time-object">time object</h5>

<p><em>you can access these methods from a <code>time</code> object:</em></p>

<ul>
<li><a href="#year">year</a><br /></li>
<li><a href="#month">month</a><br /></li>
<li><a href="#day">day</a><br /></li>
<li><a href="#hour">hour</a><br /></li>
<li><a href="#minute">minute</a><br /></li>
<li><a href="#second">second</a><br /></li>
<li><a href="#nanosecond">nanosecond</a><br /></li>
</ul>

<hr />

<h2 id="function-definitions-2">Function Definitions:</h2>

<p><a id="time"></a></p>

<h4 id="time">time</h4>

<p><code>time.time(time_string, format_string, location_string)</code></p>

<p>converts a time string, that is in format to a time object. Returns a time object. If no format or location are given, it assumes you mean to to use RFC3339: &ldquo;2006-01-02T15:04:05Z07:00&rdquo;. To learn more about format strings checkout to <a href="https://golang.org/src/time/format.go">time/format</a> golang page, or this <a href="https://flaviocopes.com/go-date-time-format/">helpful blog post</a> from flaviocopes</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="c1"># an example with no format or location string</span>
  <span class="n">time_string</span> <span class="o">=</span> <span class="s2">&#34;2018-10-31T00:00:00Z&#34;</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">time_string</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">month</span><span class="p">())</span> <span class="c1"># prints 10</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">day</span><span class="p">())</span> <span class="c1"># prints 31</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">year</span><span class="p">())</span> <span class="c1"># prints 2018</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="c1"># an example with a format and location string:</span>
  <span class="c1"># basically, as long as you use the data</span>
  <span class="c1"># Mon Jan 2 15:04:05 -0700 MST 2006 as a reference, you are good</span>
  <span class="k">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">location</span><span class="p">(</span><span class="s2">&#34;America/New_York&#34;</span><span class="p">))</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="s2">&#34;November 15, 2018&#34;</span><span class="p">,</span> <span class="s2">&#34;January 2, 2006&#34;</span><span class="p">,</span> <span class="s2">&#34;America/New_York&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">month</span><span class="p">())</span> <span class="c1"># prints 11</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">day</span><span class="p">())</span> <span class="c1"># prints 15</span>
  <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">year</span><span class="p">())</span> <span class="c1"># prints 2018</span>
  <span class="k">return</span> <span class="n">ds</span> </code></pre></div>
<p><a id="duration"></a></p>

<h4 id="duration">duration</h4>

<p><code>time.duration(duration_string)</code></p>

<p>converts a string in &lsquo;00h0m0s&rsquo; format to a duration object, returns a duration.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">duration_1_str</span> <span class="o">=</span> <span class="s2">&#34;450h79m300s&#34;</span>
  <span class="n">duration_2_str</span> <span class="o">=</span> <span class="s2">&#34;0h0m1s&#34;</span>
  <span class="c1">#</span>
  <span class="n">d1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">duration_1_str</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="c1"># prints &#34;451h24m0s&#34;, notice how it parsed the string and converted 300 seconds into 5 min, and 79 + 5 min into 1hr 24 min</span>
  <span class="c1">#</span>
  <span class="n">d2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">duration_2_str</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span> <span class="c1"># prints &#34;1s&#34;</span>
  <span class="c1">#</span>
  <span class="k">print</span><span class="p">(</span><span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span><span class="p">)</span> <span class="c1"># prints &#34;451h24m1s&#34;</span>
  <span class="k">print</span><span class="p">(</span><span class="n">d1</span>

  <span class="n">d2</span><span class="p">)</span> <span class="c1"># prints &#34;451h23m59s&#34;</span>
  <span class="c1">#</span>
  <span class="c1"># create another duration, same length as d2</span>
  <span class="c1">#</span>
  <span class="n">d3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">duration_2_str</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span> <span class="p">)</span> <span class="c1"># prints true</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p>You also get a duration when you subtract two times:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">oct_1</span> <span class="o">=</span> <span class="s2">&#34;2018-10-01T00:00:00Z&#34;</span>
  <span class="n">halloween</span> <span class="o">=</span> <span class="s2">&#34;2018-10-31T00:00:00Z&#34;</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">oct_1</span><span class="p">)</span>
  <span class="n">h</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">halloween</span><span class="p">)</span>
  <span class="n">duration</span> <span class="o">=</span> <span class="n">h</span>

  <span class="n">f</span> <span class="c1"># subtracting two time values gives you a duration</span>
  <span class="k">print</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span> <span class="c1"># prints &#34;720h0m0s&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="location"></a></p>

<h4 id="location">location</h4>

<p><code>time.location(location_string)</code></p>

<p>loads location based on string. Empty string returns &ldquo;UTC&rdquo;</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">loc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">location</span><span class="p">(</span><span class="s2">&#34;EST&#34;</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="c1"># returns &#34;EST&#34;</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="now"></a></p>

<h4 id="now">now</h4>

<p><code>time.now()</code></p>

<p>returns the current time</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;time.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;time&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="p">)</span> <span class="c1"># returns current time</span>
  <span class="c1">#</span>
  <span class="c1"># print date in MM/DD/YYYY format:</span>
  <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">month</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">day</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">year</span><span class="p">()))</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="year"></a></p>

<h4 id="year">year</h4>

<p><code>t.year()</code></p>

<p>returns year as int</p>

<p><a id="month"></a></p>

<h4 id="month">month</h4>

<p><code>t.month()</code></p>

<p>returns month as int</p>

<p><a id="day"></a></p>

<h4 id="day">day</h4>

<p><code>t.day()</code></p>

<p>returns day as int</p>

<p><a id="hour"></a></p>

<h4 id="hour">hour</h4>

<p><code>t.hour()</code></p>

<p>returns hour as int</p>

<p><a id="minute"></a></p>

<h4 id="minute">minute</h4>

<p><code>t.minute()</code></p>

<p>returns minute as int</p>

<p><a id="second"></a></p>

<h4 id="second">second</h4>

<p><code>t.second()</code></p>

<p>returns second as int</p>

<p><a id="nanosecond"></a></p>

<h4 id="nanosecond">nanosecond</h4>

<p><code>t.nanosecond()</code></p>

<p>returns nanosecond as int</p>

<hr />

<p><a id="xlsx_module"></a></p>

<h2 id="xlsx-module">xlsx module</h2>

<p><em>you can access these methods from the <code>xlsx</code> module. <code>xlsx</code> can only be used in the <code>download</code> function:</em></p>

<ul>
<li><a href="#get_url">xlsx.get_url</a></li>
<li><a href="#get_sheets">get_sheets</a></li>
<li><a href="#get_rows">get_rows</a></li>
</ul>

<hr />

<h2 id="function-definitions-3">Function Definitions:</h2>

<p><a id="get_url"></a></p>

<h4 id="xlsx-get-url">xlsx.get_url</h4>

<p><code>xlsx.get_url(url)</code></p>

<p>makes a get request of the url, attempts to return the body as a xlsx file. Can only be used in the <code>download</code> function</p>

<p>This example shows how to use <code>get_url</code>, <code>get_sheets</code>, and <code>get_rows</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">load</span><span class="p">(</span><span class="s2">&#34;xlsx.sky&#34;</span><span class="p">,</span> <span class="s2">&#34;xlsx&#34;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">xlsx</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s2">&#34;https://www.ntia.doc.gov/files/ntia/publications/225-5000-composite-inventory_2015-12-16.xlsx&#34;</span><span class="p">)</span>
  <span class="c1">#</span>
  <span class="c1"># get the sheets of the xlsx file</span>
  <span class="c1"># and print. Will print out a map of ints to sheet names:</span>
  <span class="n">sheets</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_sheets</span><span class="p">()</span>
  <span class="k">print</span><span class="p">(</span><span class="n">sheets</span><span class="p">)</span>
  <span class="c1">#</span>
  <span class="c1"># get name of first sheet and print:</span>
  <span class="n">sheet1</span> <span class="o">=</span> <span class="n">sheets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">print</span><span class="p">(</span><span class="n">sheet1</span><span class="p">)</span> <span class="c1"># prints &#34;Sheet1&#34;</span>
  <span class="c1">#</span>
  <span class="c1"># get data from sheet 1 and print:</span>
  <span class="n">rows</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_rows</span><span class="p">(</span><span class="n">sheet1</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="c1"># prints 2d list of data</span>
  <span class="c1">#</span>
  <span class="c1"># set the first 10 rows as the body:</span>
  <span class="n">ds</span><span class="o">.</span><span class="n">set_body</span><span class="p">(</span><span class="n">rows</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">ds</span></code></pre></div>
<p><a id="get_sheets"></a></p>

<h4 id="get-sheets">get_sheets</h4>

<p><code>x.get_sheets()</code></p>

<p>returns a map of ints to sheet names, indexing starts with 1. See above <code>get_url</code> example for use.</p>

<p><a id="get_rows"></a></p>

<h4 id="get-rows">get_rows</h4>

<p><code>x.get_rows(sheet_name)</code></p>

<p>returns a 2 dimensional list of data from the specified sheet. See above <code>get_url</code> example for use</p>

<p><a id="zipfile_module"></a></p>

<h2 id="zipfile-module">zipfile module</h2>

<p>_docs coming soon. In the meantime see <a href="https://godoc.org/github.com/qri-io/starlib/zipfile">https://godoc.org/github.com/qri-io/starlib/zipfile</a></p>

    </div>
  </section>
</div>
</main>
  <footer></footer>


  <script src="../../../js/kube.js" type="text/javascript">
  </script>
  <script src="../../../js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="../../../js/master.js" type="text/javascript">
  </script>
</body>

</html>
